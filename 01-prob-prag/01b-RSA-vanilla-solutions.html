
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Solutions Sheet 1.1: Vanilla RSA &#8212; Neural Pragmatic Natural Language Generation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/npNLG-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Neural Pragmatic Natural Language Generation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../000-intro.html">
                    Pragmatic Natural Language Generation with Neural Language Models
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  00 organization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00-organization/00a-overview.html">
   Course overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00-organization/00b-practicalities.html">
   Practicalities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00-organization/00c-schedule.html">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../00-organization/00d-slides.html">
   Slides from session 1
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  01 Probabilistic pragmatics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01a-prob-prag.html">
   Probabilistic pragmatics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01b-RSA-vanilla.html">
   Sheet 1.1: Vanilla RSA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01c-RSA-politeness.html">
   Sheet 1.2: RSA with politeness
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  02 PyTorch Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../02-pytorch/02a-pytorch-basics.html">
   Basics of PyTorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02-pytorch/02b-pytorch-intro.html">
   Sheet 2.1: PyTorch essentials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02-pytorch/02c-MLE.html">
   Sheet 2.2: ML-estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  03 Optimization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../03-optimization/03a-optimization.html">
   Optimization in PyTorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03-optimization/03b-gradient-descent.html">
   Sheet 3.1: Gradient descent by hand
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03-optimization/03c-RSA-pytorch.html">
   Sheet 3.2: Optimizing an RSA model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  04 ANNs in PyTorch
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../04-ANNs/04a-ANNs.html">
   Artificial neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04-ANNs/04b-algebra.html">
   Linear algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04-ANNs/04c-MLP-custom.html">
   Sheet 4.1: Non-linear regression (custom MLP)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04-ANNs/04d-MLP-pytorch.html">
   Sheet 4.2: Non-linear regression (MLP w/ PyTorch modules)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  05 RNNs in PyTorch
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../05-RNNs/05a-RNNs.html">
   Recurrent neural networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05-RNNs/05b-char-level-RNN.html">
   Sheet 5.1: Character-level sequence modeling w/ RNNs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  06 LSTMs in PyTorch
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../06-LSTMs/06a-LSTMs.html">
   Long-Short Term Memory (LSTM) models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06-LSTMs/06b-LSTM-minimal-forward-pass.html">
   Sheet 6.1: Anatomy of a single LSTM forward pass
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06-LSTMs/06c-char-level-LSTM.html">
   Sheet 6.2: Character-level sequence modeling w/ LSTMs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06-LSTMs/06d-decoding-GPT2.html">
   Sheet 6.3: Decoding strategies
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  07 Large language models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../07-LLMs/07a-LLMs.html">
   Large Language Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07-LLMs/07b-pretrained-LLMs.html">
   Sheet 7.1: Using pretrained LLMs w/ the ‘transformers’ package
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  08 Grounded language models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../08-grounded-LMs/08a-grounded-LMs.html">
   Grounded Language Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08-grounded-LMs/08b-LSTM-3DShapes.html">
   Sheet 8.1: An LSTM-based image captioner for the annotated 3D-Shapes data set
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08-grounded-LMs/08c-NIC-pretrained.html">
   Sheet 8.2: Using 🤗’s pretrained models for image captioning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  09 neural-pragmatic NLG
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../09-np-NLG/09a-np-NLG.html">
   Neural pragmatic Natural Language Generation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09-np-NLG/09b-project-ideas.html">
   Project ideas
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/michael-franke/npNLG/main?urlpath=tree/neural_pragmatic_nlg/01-prob-prag/01b-RSA-vanilla-solutions.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/michael-franke/npNLG/blob/main/neural_pragmatic_nlg/01-prob-prag/01b-RSA-vanilla-solutions.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/michael-franke/npNLG"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/michael-franke/npNLG/issues/new?title=Issue%20on%20page%20%2F01-prob-prag/01b-RSA-vanilla-solutions.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/01-prob-prag/01b-RSA-vanilla-solutions.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Solutions Sheet 1.1: Vanilla RSA</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="solutions-sheet-1-1-vanilla-rsa">
<h1>Solutions Sheet 1.1: Vanilla RSA<a class="headerlink" href="#solutions-sheet-1-1-vanilla-rsa" title="Permalink to this headline">#</a></h1>
<p><strong>Author:</strong> Michael Franke</p>
<p>Imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Context model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################</span>
<span class="c1">## defining the context</span>
<span class="c1">##################################################</span>

<span class="n">object_names</span>    <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue_circle&#39;</span><span class="p">,</span> <span class="s1">&#39;green_square&#39;</span><span class="p">,</span> <span class="s1">&#39;blue_square&#39;</span><span class="p">]</span>
<span class="n">utterance_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;square&#39;</span><span class="p">]</span>

<span class="n">semantic_meaning</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="c1"># blue circle, green square, blue square</span>
    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># blue</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># circle</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># green</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>  <span class="c1"># square,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Helper functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################</span>
<span class="c1">## helper functions</span>
<span class="c1">##################################################</span>

<span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Softmax function in numpy</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x: array</span>
<span class="sd">        An array with any dimensionality</span>
<span class="sd">    axis: int</span>
<span class="sd">        The axis along which to apply the softmax</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array</span>
<span class="sd">        Same shape as x</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">e_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">e_x</span> <span class="o">/</span> <span class="n">e_x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalize arr along axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">arr</span> <span class="o">/</span> <span class="n">arr</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong><span style=&ldquo;color:#D83D2B;&rdquo;>Exercise 1.1.1: Apply the helper functions</span></strong></p>
<ol class="simple">
<li><p>Normalize the following matrix to a row-stochastic and a column-stochastic matrix for the matrix: <span class="math notranslate nohighlight">\([[1,2], [3,4]]\)</span>.</p></li>
<li><p>Apply softmax to the following matrix to obtain a row-stochastic and a column-stochastic matrix:  <span class="math notranslate nohighlight">\([[1,2], [3,4], [5,6]]\)</span>.</p></li>
<li><p>Compute the soft-max and the normalized stochastic vector for the vector <span class="math notranslate nohighlight">\([1,2,3]\)</span>. (NB: the definitions do <em>not</em> expect vector input, so … what do you do?)</p></li>
</ol>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################</span>
<span class="c1">## solutions here for exercise 1.1.1</span>
<span class="c1">##################################################</span>

<span class="c1"># 1.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 1&quot;</span><span class="p">)</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;starting point:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">m1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;row-stochastic:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;col-stochastic:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># 2.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Part 2&quot;</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;starting point:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;row-stochastic:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">softmax</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;col-stochastic:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">softmax</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># 3.</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Part 3&quot;</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;starting point:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;softmax:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">softmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span><span class="p">]),</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;normalize:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">normalize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span><span class="p">]),</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>#+begin_example
Part 1
starting point:
 [[1 2]
 [3 4]]
row-stochastic:
 [[0.33333333 0.66666667]
 [0.42857143 0.57142857]]
col-stochastic:
 [[0.25       0.33333333]
 [0.75       0.66666667]]

Part 2
starting point:
 [[1 2]
 [3 4]
 [5 6]]
row-stochastic:
 [[0.26894142 0.73105858]
 [0.26894142 0.73105858]
 [0.26894142 0.73105858]]
col-stochastic:
 [[0.01587624 0.01587624]
 [0.11731043 0.11731043]
 [0.86681333 0.86681333]]

Part 3
starting point:
 [1 2 3]
softmax:
 [0.09003057 0.24472847 0.66524096]
normalize:
 [0.16666667 0.33333333 0.5       ]
#+end_example
</pre></div>
</div>
</div>
</div>
<p>The model we want to implement is defined as follows:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
P_{lit}(s \mid u) &amp; \propto L(u,s) \\
P_S( u \mid s) &amp;= \mathrm{SoftMax}  \left ( \alpha \left ( \log P_{lit}(s \mid u)  - \mathrm{C}(u) \right ) \right ) \\
P_L( s \mid u) &amp; \propto P_{sal}(s) \ P_S( u \mid s)
\end{align*}\]</div>
<blockquote>
<div><p><strong><span style=&ldquo;color:#D83D2B;&rdquo;>Exercise 1.1.2: Paraphrase the definitions</span></strong></p>
<p>Provide a short, intuitive and explanatory paraphrase for each of the three conditional probability distributions that define the RSA model above. I.e., formulate a sentence or two for each, so that a person can understand the purpose or gist of the definition. The less technical jargon you use, the better. The more insightful to a novice, the better.</p>
</div></blockquote>
<blockquote>
<div><p><strong><span style=&ldquo;color:#D83D2B;&rdquo;>Solutions for Exercise 1.1.2</span></strong></p>
<p>The literal listener is a conditional probability, where the probability of a state <span class="math notranslate nohighlight">\(s\)</span> given an utterance <span class="math notranslate nohighlight">\(u\)</span> is proportional to the truth-value of <span class="math notranslate nohighlight">\(u\)</span> in <span class="math notranslate nohighlight">\(s\)</span>. This means that the literal listener assigns equal probability to each state in which <span class="math notranslate nohighlight">\(u\)</span> is true.</p>
<p>The speaker assigns a probability to each utterance proportionally to how good that utterance is. Goodness is defined in terms of informativity and a cost term.</p>
<p>The pragmatic speaker is defined in terms of Bayes rule, based on a salience prior over states and the speaker’s production protocol as a likelihood function.</p>
</div></blockquote>
<p>Implementation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################</span>
<span class="c1">## model parameters</span>
<span class="c1">##################################################</span>

<span class="n">alpha</span>              <span class="o">=</span> <span class="mi">1</span>
<span class="n">cost_adjectives</span>    <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">salience_prior_flt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>     <span class="c1"># flat</span>
<span class="n">salience_prior_emp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">71</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span> <span class="c1"># empirical</span>

<span class="c1">##################################################</span>
<span class="c1">## RSA model predictions</span>
<span class="c1">##################################################</span>


<span class="k">def</span> <span class="nf">RSA</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">cost_adjectives</span><span class="p">,</span> <span class="n">salience_prior</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    predictions of the vanilla RSA model for reference game</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alpha: float</span>
<span class="sd">        Optimality parameter</span>
<span class="sd">    cost_adjectives: float</span>
<span class="sd">        Differential cost for production of adjectives</span>
<span class="sd">    salience_prior: array</span>
<span class="sd">        Prior over objects</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dictionary</span>
<span class="sd">        Dictionary with keys &#39;speaker&#39; and &#39;listener&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">costs</span>              <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">cost_adjectives</span>
    <span class="n">literal_listener</span>   <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">semantic_meaning</span><span class="p">)</span>
    <span class="n">util_speaker</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">literal_listener</span><span class="p">))</span> <span class="o">-</span> <span class="n">costs</span>
    <span class="n">pragmatic_speaker</span>  <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">util_speaker</span><span class="p">)</span>
    <span class="n">pragmatic_listener</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">pragmatic_speaker</span><span class="p">)</span> <span class="o">*</span> <span class="n">salience_prior</span><span class="p">)</span>
    <span class="k">return</span><span class="p">({</span><span class="s1">&#39;speaker&#39;</span><span class="p">:</span> <span class="n">pragmatic_speaker</span><span class="p">,</span> <span class="s1">&#39;listener&#39;</span><span class="p">:</span> <span class="n">pragmatic_listener</span><span class="p">})</span>

<span class="n">RSA_predictions</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">cost_adjectives</span><span class="p">,</span> <span class="n">salience_prior_flt</span><span class="p">)</span>

<span class="c1">##################################################</span>
<span class="c1">## cast model predictions to DataFrames</span>
<span class="c1">##################################################</span>

<span class="n">speaker</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">RSA_predictions</span><span class="p">[</span><span class="s1">&#39;speaker&#39;</span><span class="p">],</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="n">object_names</span><span class="p">,</span>
                        <span class="n">columns</span> <span class="o">=</span> <span class="n">utterance_names</span><span class="p">)</span>
<span class="n">speaker</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">speaker</span><span class="o">.</span><span class="n">index</span>
<span class="nb">print</span><span class="p">(</span><span class="n">speaker</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="n">listener</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span>    <span class="o">=</span> <span class="n">RSA_predictions</span><span class="p">[</span><span class="s1">&#39;listener&#39;</span><span class="p">],</span>
                        <span class="n">index</span>   <span class="o">=</span> <span class="n">utterance_names</span><span class="p">,</span>
                        <span class="n">columns</span> <span class="o">=</span> <span class="n">object_names</span><span class="p">)</span>
<span class="n">listener</span><span class="p">[</span><span class="s1">&#39;utterance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">listener</span><span class="o">.</span><span class="n">index</span>
<span class="nb">print</span><span class="p">(</span><span class="n">listener</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1">##################################################</span>
<span class="c1">## plotting the results</span>
<span class="c1">##################################################</span>

<span class="n">speaker_long</span> <span class="o">=</span> <span class="n">speaker</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;utterance&quot;</span><span class="p">,</span>
                            <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">speaker_plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">speaker_long</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
<span class="n">speaker_plot</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">,</span> <span class="s2">&quot;utterance&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">listener_long</span> <span class="o">=</span> <span class="n">listener</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;utterance&quot;</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                              <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;probability&quot;</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">listener_plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">listener_long</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;utterance&quot;</span><span class="p">)</span>
<span class="n">listener_plot</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>blue  circle  green  square        object
blue_circle   0.31    0.69   0.00    0.00   blue_circle
green_square  0.00    0.00   0.64    0.36  green_square
blue_square   0.48    0.00   0.00    0.52   blue_square
        blue_circle  green_square  blue_square utterance
blue            0.4           0.0          0.6      blue
circle          1.0           0.0          0.0    circle
green           0.0           1.0          0.0     green
square          0.0           0.4          0.6    square
</pre></div>
</div>
<img alt="../_images/01b-RSA-vanilla-solutions_10_1.png" src="../_images/01b-RSA-vanilla-solutions_10_1.png" />
<img alt="../_images/01b-RSA-vanilla-solutions_10_2.png" src="../_images/01b-RSA-vanilla-solutions_10_2.png" />
</div>
</div>
<blockquote>
<div><p><strong><span style=&ldquo;color:#D83D2B;&rdquo;>Exercise 1.1.3: Explore the vanilla RSA model</span></strong></p>
<ol class="simple">
<li><p>[for your own sake only; no written answer required] Go through the whole last code block. Try to understand every single line in the function `RSA<sub>predictions</sub>`. Ask if anything is unclear. (It is muss less important to understand the details of the subsequent data wrangling and plotting.)</p></li>
<li><p>Explore what happens if you make the speaker more optimal. Does that also affect the listener’s inferences? Why? Is that intuitive?</p></li>
<li><p>Add another object to the context, namely a red triangle. Add any relevant utterances, their semantics and costs as well. What do you predict will happen to the model’s predictions for the “old” objects and utterances? Test your predictions (= understanding of the model) and report the results.</p></li>
<li><p>Run the model with different values for the cost parameter `cost<sub>adjectives</sub>`. Which effect does this have on the speaker prediction? Which effect does that have on the predictions for listener interpretation? Explain these observations in your own non-technical terms (e.g., for an interested outsider).</p></li>
<li><p>Is there any way to get “blue” to refer to something green? I.e., is it possible (if so: how?; else: why not?) to change the context or model in such a way that <span class="math notranslate nohighlight">\(P_{L}(\text{green square} \mid \text{blue}) &gt; 0\)</span>, ideally in a way that might also be defensible in that it makes conceptual sense (not just by some technical trick that no reviewer of your work would accept as anything but a hack)?</p></li>
</ol>
</div></blockquote>
<blockquote>
<div><p><strong><span style=&ldquo;color:#D83D2B;&rdquo;>Solutions for Exercise 1.1.3</span></strong></p>
<ol class="simple">
<li><p>Making the speaker more optimal is achieved by increasing the value of <span class="math notranslate nohighlight">\(\alpha\)</span>. The higher <span class="math notranslate nohighlight">\(\alpha\)</span>, the more the speaker rule approximates a purely rational agent who always chooses the (or an) utterance that maximizes the utility score. As the listener is defined in terms of Bayes rule, with <span class="math notranslate nohighlight">\(P_{S}\)</span> as a likelihood function, changes of <span class="math notranslate nohighlight">\(\alpha\)</span> also affect the listener’s interpretation. This is intuitive because my interpretation of an utterance almost certainly changes if my belief about the rationality (or idioticity) of the speaker changes.</p></li>
<li><p>We predict that adding a red triangle and words ’red’ and ’triangle’ will not change the predictions for the “old part” of the context model, because the new words will all be false of all the old objects.
Adding another object gives us a new context model.
The previous RSA function was (deliberately!?!) written in such a way that we cannot use it as-is for this amended context model. Let’s fix this in a general way:</p></li>
</ol>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################</span>
<span class="c1">## defining the context</span>
<span class="c1">##################################################</span>

<span class="n">object_names</span>    <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue_circle&#39;</span><span class="p">,</span> <span class="s1">&#39;green_square&#39;</span><span class="p">,</span> <span class="s1">&#39;blue_square&#39;</span><span class="p">,</span> <span class="s1">&#39;red triangle&#39;</span><span class="p">]</span>
<span class="n">utterance_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">]</span>

<span class="n">semantic_meaning</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="c1"># blue circle, green square, blue square, red triangle</span>
    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># blue</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># circle</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># green</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># square</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># red,</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>  <span class="c1"># triangle</span>
    <span class="p">)</span>

<span class="n">cost_adjectives</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">context_model</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;object_names&#39;</span>     <span class="p">:</span> <span class="n">object_names</span><span class="p">,</span>
    <span class="s1">&#39;utterance_names&#39;</span>  <span class="p">:</span> <span class="n">utterance_names</span><span class="p">,</span>
    <span class="s1">&#39;semantic_meaning&#39;</span> <span class="p">:</span> <span class="n">semantic_meaning</span><span class="p">,</span>
    <span class="s1">&#39;costs&#39;</span>            <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">cost_adjectives</span><span class="p">,</span>
    <span class="s1">&#39;salience_prior&#39;</span>   <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">4</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">RSARev</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">context_model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    predictions of the vanilla RSA model for reference game</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alpha: float</span>
<span class="sd">        Optimality parameter</span>
<span class="sd">    context_model: dict</span>
<span class="sd">        Objects &amp; their salience, utterances &amp; their meanings &amp; costs</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dictionary</span>
<span class="sd">        Dictionary with keys &#39;speaker&#39; and &#39;listener&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">costs</span>              <span class="o">=</span> <span class="n">context_model</span><span class="p">[</span><span class="s1">&#39;costs&#39;</span><span class="p">]</span>
    <span class="n">literal_listener</span>   <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">context_model</span><span class="p">[</span><span class="s1">&#39;semantic_meaning&#39;</span><span class="p">])</span>
    <span class="n">util_speaker</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">literal_listener</span><span class="p">))</span> <span class="o">-</span> <span class="n">costs</span>
    <span class="n">pragmatic_speaker</span>  <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">util_speaker</span><span class="p">)</span>
    <span class="n">pragmatic_listener</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">pragmatic_speaker</span><span class="p">)</span> <span class="o">*</span>
                                   <span class="n">context_model</span><span class="p">[</span><span class="s1">&#39;salience_prior&#39;</span><span class="p">])</span>
    <span class="k">return</span><span class="p">({</span><span class="s1">&#39;speaker&#39;</span><span class="p">:</span> <span class="n">pragmatic_speaker</span><span class="p">,</span> <span class="s1">&#39;listener&#39;</span><span class="p">:</span> <span class="n">pragmatic_listener</span><span class="p">})</span>

<span class="n">RSA_predictions</span> <span class="o">=</span> <span class="n">RSARev</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">context_model</span><span class="p">)</span>

<span class="c1">##################################################</span>
<span class="c1">## cast model predictions to DataFrames</span>
<span class="c1">##################################################</span>

<span class="n">speakerRev</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">RSA_predictions</span><span class="p">[</span><span class="s1">&#39;speaker&#39;</span><span class="p">],</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="n">object_names</span><span class="p">,</span>
                        <span class="n">columns</span> <span class="o">=</span> <span class="n">utterance_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">speakerRev</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="n">listener</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span>    <span class="o">=</span> <span class="n">RSA_predictions</span><span class="p">[</span><span class="s1">&#39;listener&#39;</span><span class="p">],</span>
                        <span class="n">index</span>   <span class="o">=</span> <span class="n">utterance_names</span><span class="p">,</span>
                        <span class="n">columns</span> <span class="o">=</span> <span class="n">object_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">listener</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>#+begin_example
              blue  circle  green  square   red  triangle
blue_circle   0.31    0.69   0.00    0.00  0.00      0.00
green_square  0.00    0.00   0.64    0.36  0.00      0.00
blue_square   0.48    0.00   0.00    0.52  0.00      0.00
red triangle  0.00    0.00   0.00    0.00  0.48      0.52
          blue_circle  green_square  blue_square  red triangle
blue             0.06          0.00         0.94           0.0
circle           1.00          0.00         0.00           0.0
green            0.00          1.00         0.00           0.0
square           0.00          0.06         0.94           0.0
red              0.00          0.00         0.00           1.0
triangle         0.00          0.00         0.00           1.0
#+end_example
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><ol class="simple">
<li><p>Increasing the cost parameter makes the speaker prefer nouns more strongly over adjectives. If we set it to negative values, the pattern is reversed. This parameter also affects the listener part. For example, if costs of adjectives are very high, the speaker will prefer to also choose “square” for the green square, thus overriding the pressure to be informative. As a result, when the listener hears “square” they will think that it is (roughly) equally likely that the speaker is referring to the “green square” or the “blue square”.</p></li>
<li><p>A simple way to achieve this result is to use what is sometimes called a “soft-semantics”, where truth values are not 0 or 1, but something close to these extremes. For example:</p></li>
</ol>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">semantic_meaning</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="c1"># blue circle, green square, blue square</span>
    <span class="p">[[</span><span class="mi">1</span><span class="o">-</span><span class="n">eps</span><span class="p">,</span> <span class="n">eps</span>  <span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">eps</span><span class="p">]</span>  <span class="p">,</span>  <span class="c1"># blue</span>
     <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">eps</span><span class="p">,</span> <span class="n">eps</span>  <span class="p">,</span> <span class="n">eps</span><span class="p">]</span>    <span class="p">,</span>  <span class="c1"># circle</span>
     <span class="p">[</span><span class="n">eps</span>  <span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">eps</span><span class="p">,</span> <span class="n">eps</span><span class="p">]</span>    <span class="p">,</span>  <span class="c1"># green</span>
     <span class="p">[</span><span class="n">eps</span>  <span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">eps</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">eps</span><span class="p">]]</span>  <span class="c1"># square,</span>
   <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>One way of making plausible such a semantics is by arguing that even if a single agent is absolutely rock-certain about black-and-white truth-values, they might not be as certain about the other person’s infallible language use. (NB: the lecturer does not believe that this is a very good defense of this set up; just for the record.)</p>
</div></blockquote>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./01-prob-prag"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Michael Franke<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>